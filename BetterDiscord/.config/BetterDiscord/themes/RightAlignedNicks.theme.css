/*//META{"name":"Right-aligned Nicks2","description":"Nicknames are right-aligned","author":"FichteFoll","version":"1.1.0"}*//

/**
 * Nicks are right-aligned in compact layout.
 * Based grid.
 *
 * Requires compact mode for obvious reasons.
 *
 * Nicknames that are too long for the associated space
 * are collapsed with an ellipse.
 * You can adjust the width of the username column
 * with a variable in your user css
 * or yell at the people until they pick a shorter nick.
 */

/* Variables for configuration. You can override these in your user css. */
:root {
    /* ch as unit makes the most sense here,
     * but the column width is determined before the username text size */
    --username-width: 7.3rem;
    --timestamp-width: 3rem;
    --message-gap: 0.4rem;
}

[class*=message-][class*=compact-] {
    /* idk why there is negative padding on this */
    padding-left: 1rem;
    display: grid;
    grid-template-columns: [header] calc(var(--timestamp-width) + var(--username-width))
                           [content] auto;
}

/* the header (contains timestamp & username) */
[class*=headerCompact-] {
    display: grid;
    grid-template-columns: var(--timestamp-width) var(--username-width);
    text-indent: 0; /* need to reset this */
}

/* timestamp */
[class*=headerCompact-] [class*=timestampBase-][class*=timestampCompact-] {
    text-align: left;
}

/* bot marker */
[class*=botTagCompact-] {
    /* I'm trying to show this *behind* the name
     * because I can't adjust the name's width */
    opacity: 0.7;
    grid-row-start: 1;
    grid-column-start: 2;
    width: 2em;
    position: initial;
}

/* username */
[class*=headerCompact-] > span[class*=username-] {
    display: inline-block;
    grid-row-start: 1;
    grid-column-start: 2;
    z-index: 5; /* username popup uses 10 */
    justify-self: end;
    align-self: begin;
    margin-right: var(--message-gap);
    max-width: var(--username-width);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* text */
[class*=message-] > [class*=markup-][class*=compact-] {
    display: block;
    grid-column-start: content;
    text-indent: 0;
}

/* embed */
[class*=message-][class*=compact-] [class*=container-] {
    grid-column-start: content;
}

/* edit box */
[class*=message-][class*=compact-] > h2 ~ div {
    grid-column-start: content;
}

/* add highlight marker to the right as well */
[class*=message-][class*=compact-][class*=mentioned-] {
    border-right: solid #FAA61A;
    border-width: 0 2px;
}

/* show hidden timestamps */
[class*=timestampVisibleOnHover-] {
    opacity: 1;
}

/* Adjust pin and join messages to grid */
[class*=markup-][class*=containerCozy-] {
    grid-column-end: span 2;
}
[class*=markup-][class*=containerCozy-] > [class*=container-] {
    margin-left: 0; /* reset this */
}
