/**
 * @name Right-aligned Nicks
 * @description Nicknames are right-aligned in compact mode.
 * @version 1.5.0
 * @author FichteFoll
 * @authorLink https://github.com/FichteFoll
 * @website https://github.com/FichteFoll/dotfiles
 * @source https://raw.githubusercontent.com/FichteFoll/dotfiles/master/vesktop/.config/vesktop/themes/RightAlignedNicks.theme.css
 *
 * Nicks are right-aligned in compact layout.
 * Based grid.
 *
 * Requires compact mode for obvious reasons.
 * "Show avatars in Compact mode" is not supported.
 *
 * Nicknames that are too long for the associated space
 * are collapsed with an ellipse.
 * You can adjust the width of the username column
 * with a variable in your user css
 * or yell at the people until they pick a shorter nick.
 */

/* Variables for configuration. You can override these in your user css. */
:root {
    /* ch as unit makes the most sense here,
     * but the column width is determined before the username text size */
    --username-width: 7.1rem;
    --timestamp-width: 3rem;
    --message-gap: 0.4rem;
    --message-padding: 1rem;
}

[class*=message][class*=compact] {
    padding-left: var(--message-padding); /* reset negative padding */
    margin: 0; /* and margins */
}

/* base grid layout for the main message (first container) */
[class*=message][class*=compact] > [class*=contents] {
    margin-left: 0; /* reset margin (same as padding above) */
    padding-left: 0;
    display: grid;
    grid-template-columns: [header] calc(var(--timestamp-width) + var(--username-width) + var(--message-gap))
                           [content] auto;
}

/* alignment for the rest of the message (embed, reactions) */
[class*=message][class*=compact] > [class*=container]:not(:empty) {
    margin-left: calc(var(--timestamp-width) + var(--username-width) + var(--message-gap)) !important;
/*    display: inline-block;*/
}

/* the header (contains timestamp & username) */
[class*=message][class*=compact] h3[class*=header] {
    display: inline-grid !important;
    grid-template-columns: var(--timestamp-width) var(--username-width);
    margin-right: var(--message-gap);
    text-indent: 0; /* need to reset this */
}

/* timestamp */
[class*=timestampBase][class*=timestampCompact] {
    text-align: left;
}
/* reply timestamp */
[class*=timestamp][class*=latin12CompactTimeStamp] {
    width: auto;
}

/* add highlight marker to the right as well */
[class*=message][class*=compact][class*=mentioned] {
    border-right: 2px solid #FAA61A;
}

/* bot/OP marker */
[class*=botTagCompact] {
    /* I'm trying to show this *above* the name
     * because I can't adjust the name's width.
     * The positioning is kind of â€¦ arbitrary,
     * but it works. */
    opacity: 0.7;
    transform: scale(0.8) translateX(-5px);
    position: absolute;
    top: -0.6rem;
    /*left: -4em;*/
}

/* username "container" */
[class*=message][class*=compact] h3 span[class*=headerText] {
    display: block;
    grid-row-start: 1;
    grid-column-start: 2;
    z-index: 2; /* username popup uses 10; new messages overlay 3 */
    justify-self: end;
    margin-inline-end: 0;

    span[class*=username] {
        display: inline-block;
        max-width: var(--username-width);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;

        [class*=emoji] {
            display: none;
        }
    }

    span[role=button]:has(> [class*=newMemberBadge]) {
        /* Same as for the prepended badges */
        opacity: 0.7;
        transform: scale(0.6) translateX(-1.8rem);
        position: absolute;
        top: -0.5rem;
    }
}

/* reply guide */
[class*=compact][class*=hasReply] [class*=repliedMessageClickableSpine] {
    inset-inline-end: 100%;
}

/* reply messages */
[class*=message][class*=compact] > [class*=repliedMessage] {
    margin-inline-start: calc(var(--message-padding) + var(--timestamp-width) + var(--username-width) + var(--message-gap) - 0.35rem);
    padding-inline-start: 0;
    /*idk where the 0.35 comes from */
}

[class*=replyBadge] {
    display: none;
}


/* show hidden timestamps */
[class*=timestampVisibleOnHover] {
    opacity: 1;
}

/* Adjust pin and join messages to grid */
[class*=systemMessage][class*=compact] > [class*=contents] {
    display: block;
}
[class*=systemMessage][class*=compact] [class*=container] {
    margin-left: 1rem; /* reset */
}
